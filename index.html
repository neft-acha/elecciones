<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elecciones Primarias</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .auth-container {
            max-width: 600px;
            margin: 30px auto;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        .candidate-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .candidate-card:hover {
            background-color: #f0f8ff;
        }
        .candidate-card.selected {
            border-color: #007bff;
            background-color: #e7f3ff;
        }
        .stats-container {
            margin-top: 30px;
        }
        .progress {
            height: 30px;
            margin-bottom: 15px;
        }
        .nav-tabs .nav-link.active {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1 class="text-primary">ELECCIONES PRIMARIAS</h1>
        </div>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab">Crear Cuenta</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab">Iniciar Sesión</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="vote-tab" data-bs-toggle="tab" data-bs-target="#vote" type="button" role="tab">Votar</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="stats-tab" data-bs-toggle="tab" data-bs-target="#stats" type="button" role="tab">Estadísticas</button>
            </li>
        </ul>

        <div class="tab-content auth-container" id="myTabContent">
            <!-- Pestaña de Registro -->
            <div class="tab-pane fade show active" id="register" role="tabpanel">
                <h2>Crear Cuenta</h2>
                <form id="register-form">
                    <div class="mb-3">
                        <label for="ci" class="form-label">CI</label>
                        <input type="text" class="form-control" id="ci" required>
                    </div>
                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombre" required>
                    </div>
                    <div class="mb-3">
                        <label for="apellido" class="form-label">Apellido</label>
                        <input type="text" class="form-control" id="apellido" required>
                    </div>
                    <div class="mb-3">
                        <label for="correo" class="form-label">Correo</label>
                        <input type="email" class="form-control" id="correo" required>
                    </div>
                    <div class="mb-3">
                        <label for="telefono" class="form-label">Teléfono</label>
                        <input type="tel" class="form-control" id="telefono">
                    </div>
                    <div class="mb-3">
                        <label for="departamento" class="form-label">Departamento</label>
                        <select class="form-select" id="departamento" required>
                            <option value="" selected disabled>Seleccione un departamento</option>
                            <option value="La Paz">La Paz</option>
                            <option value="Cochabamba">Cochabamba</option>
                            <option value="Santa Cruz">Santa Cruz</option>
                            <option value="Tarija">Tarija</option>
                            <option value="Potosí">Potosí</option>
                            <option value="Oruro">Oruro</option>
                            <option value="Beni">Beni</option>
                            <option value="Pando">Pando</option>
                            <option value="Chuquisaca">Chuquisaca</option>
                            <option value="El Beni">El Beni</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="nacimiento" class="form-label">Fecha de Nacimiento</label>
                        <input type="date" class="form-control" id="nacimiento" required>
                    </div>
                    <div class="mb-3">
                        <label for="votacion" class="form-label">Fecha de Votación</label>
                        <input type="date" class="form-control" id="votacion" required>
                    </div>
                    <div class="mb-3">
                        <label for="contraseña" class="form-label">Contraseña</label>
                        <input type="password" class="form-control" id="contraseña" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Registrarse</button>
                </form>
            </div>

            <!-- Pestaña de Login -->
            <div class="tab-pane fade" id="login" role="tabpanel">
                <h2>Iniciar Sesión</h2>
                <form id="login-form">
                    <div class="mb-3">
                        <label for="login-ci" class="form-label">CI</label>
                        <input type="text" class="form-control" id="login-ci" required>
                    </div>
                    <div class="mb-3">
                        <label for="login-contraseña" class="form-label">Contraseña</label>
                        <input type="password" class="form-control" id="login-contraseña" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Ingresar</button>
                    <button type="button" class="btn btn-link" id="forgot-password">Olvidé mi contraseña</button>
                </form>
            </div>

            <!-- Pestaña de Votación -->
            <div class="tab-pane fade" id="vote" role="tabpanel">
                <h2>Votar</h2>
                <div id="vote-section">
                    <p class="text-muted">Por favor inicie sesión para votar</p>
                </div>
            </div>

            <!-- Pestaña de Estadísticas -->
            <div class="tab-pane fade" id="stats" role="tabpanel">
                <h2>Estadísticas de Votación</h2>
                <div id="stats-section">
                    <p class="text-muted">Los resultados se mostrarán aquí una vez que comience la votación</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Datos de la aplicación
        const candidates = [
            { id: 1, name: "Juan Pérez", party: "Partido A", color: "#007bff" },
            { id: 2, name: "María García", party: "Partido B", color: "#dc3545" },
            { id: 3, name: "Carlos López", party: "Partido C", color: "#28a745" },
            { id: 4, name: "Ana Rodríguez", party: "Partido D", color: "#ffc107" },
            { id: 5, name: "Luis Fernández", party: "Partido E", color: "#17a2b8" },
            { id: 6, name: "Sofía Martínez", party: "Partido F", color: "#6610f2" },
            { id: 7, name: "Pedro Sánchez", party: "Partido G", color: "#6f42c1" },
            { id: 8, name: "Laura Jiménez", party: "Partido H", color: "#e83e8c" },
            { id: 9, name: "Javier Torres", party: "Partido I", color: "#fd7e14" },
            { id: 10, name: "Clara Ramos", party: "Partido J", color: "#343a40" }
        ];

        let voters = [];
        let votes = Array(candidates.length).fill(0);
        let currentVoter = null;

        // Simulación de votantes ficticios
        const simulateVotes = () => {
            const simulatedVoters = [
                { ci: "12345678", nacimiento: "2000-01-01", voto: 1 },
                { ci: "23456789", nacimiento: "1995-06-15", voto: 2 },
                { ci: "34567890", nacimiento: "1980-03-20", voto: 3 },
                { ci: "45678901", nacimiento: "1992-11-30", voto: 4 },
                { ci: "56789012", nacimiento: "1998-05-10", voto: 1 },
                { ci: "67890123", nacimiento: "1985-07-25", voto: 5 },
                { ci: "78901234", nacimiento: "1993-09-12", voto: 6 },
                { ci: "89012345", nacimiento: "1990-04-18", voto: 7 },
                { ci: "90123456", nacimiento: "1988-02-22", voto: 8 },
                { ci: "01234567", nacimiento: "1991-12-14", voto: 9 },
            ];

            simulatedVoters.forEach(voter => {
                votes[voter.voto - 1]++;
            });
        };

        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Simular la votación al cargar
            simulateVotes();

            // Formulario de registro
            document.getElementById('register-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const birthDate = new Date(document.getElementById('nacimiento').value);
                const age = new Date().getFullYear() - birthDate.getFullYear();

                // Verificar si el usuario es mayor de 18 años
                if (age < 18) {
                    alert('Debes tener al menos 18 años para registrarte.');
                    return;
                }
                
                const voter = {
                    ci: document.getElementById('ci').value,
                    nombre: document.getElementById('nombre').value,
                    apellido: document.getElementById('apellido').value,
                    correo: document.getElementById('correo').value,
                    telefono: document.getElementById('telefono').value,
                    departamento: document.getElementById('departamento').value,
                    nacimiento: document.getElementById('nacimiento').value,
                    votacion: document.getElementById('votacion').value,
                    contraseña: document.getElementById('contraseña').value,
                    hasVoted: false
                };
                
                // Verificar si el votante ya existe
                if (voters.some(v => v.ci === voter.ci)) {
                    alert('Ya existe un votante con esta CI');
                    return;
                }
                
                voters.push(voter);
                alert('Registro exitoso. Ahora puede iniciar sesión.');
                document.getElementById('register-form').reset();
                document.getElementById('login-tab').click();
            });
            
            // Formulario de login
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const ci = document.getElementById('login-ci').value;
                const contraseña = document.getElementById('login-contraseña').value;
                
                const voter = voters.find(v => v.ci === ci && v.contraseña === contraseña);
                
                if (voter) {
                    if (voter.hasVoted) {
                        alert('Usted ya ha ejercido su derecho al voto.');
                    } else {
                        currentVoter = voter;
                        alert('Ingreso exitoso. Ahora puede votar.');
                        document.getElementById('login-form').reset();
                        document.getElementById('vote-tab').click();
                        showCandidates();
                    }
                } else {
                    alert('CI o contraseña incorrectos');
                }
            });
            
            // Olvidé contraseña
            document.getElementById('forgot-password').addEventListener('click', function(e) {
                e.preventDefault();
                alert('Por favor contacte al administrador del sistema para recuperar su acceso.');
            });
            
            // Mostrar candidatos
            function showCandidates() {
                const voteSection = document.getElementById('vote-section');
                voteSection.innerHTML = `
                    <h4>Seleccione un candidato:</h4>
                    <p>Solo puede elegir uno</p>
                    <form id="vote-form">
                        ${candidates.map(candidate => `
                            <div class="form-check candidate-card mb-3">
                                <input class="form-check-input" type="radio" name="candidate" id="candidate-${candidate.id}" value="${candidate.id}">
                                <label class="form-check-label" for="candidate-${candidate.id}">
                                    <h5>${candidate.name}</h5>
                                    <p class="text-muted">${candidate.party}</p>
                                </label>
                            </div>
                        `).join('')}
                        <button type="submit" class="btn btn-primary">Votar</button>
                    </form>
                `;
                
                // Agregar evento para seleccionar candidato
                document.querySelectorAll('.form-check-input').forEach(radio => {
                    radio.addEventListener('change', function() {
                        document.querySelectorAll('.candidate-card').forEach(card => {
                            card.classList.remove('selected');
                        });
                        if (this.checked) {
                            this.closest('.candidate-card').classList.add('selected');
                        }
                    });
                });
                
                // Formulario de votación
                document.getElementById('vote-form').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const selectedCandidate = document.querySelector('input[name="candidate"]:checked');
                    
                    if (!selectedCandidate) {
                        alert('Por favor seleccione un candidato');
                        return;
                    }
                    
                    const candidateId = parseInt(selectedCandidate.value);
                    votes[candidateId - 1]++;
                    currentVoter.hasVoted = true;
                    
                    alert('¡Su voto ha sido registrado con éxito!');
                    document.getElementById('vote-form').reset();
                    document.querySelectorAll('.candidate-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    
                    // Actualizar estadísticas
                    updateStats();
                    document.getElementById('stats-tab').click();
                });
            }
            
            // Actualizar estadísticas
            function updateStats() {
                const totalVotes = votes.reduce((a, b) => a + b, 0);
                const statsSection = document.getElementById('stats-section');
                
                if (totalVotes === 0) {
                    statsSection.innerHTML = '<p>Aún no hay votos registrados</p>';
                    return;
                }
                
                statsSection.innerHTML = `
                    <h4>Resultados parciales:</h4>
                    <p>Total de votos: ${totalVotes}</p>
                    ${candidates.map((candidate, index) => {
                        const percentage = totalVotes > 0 ? Math.round((votes[index] / totalVotes) * 100) : 0;
                        return `
                            <div class="mb-3">
                                <h5>${candidate.name} - ${candidate.party}</h5>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: ${percentage}%; background-color: ${candidate.color};" 
                                        aria-valuenow="${votes[index]}" aria-valuemin="0" aria-valuemax="${totalVotes}">
                                        ${votes[index]} votos (${percentage}%)
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                `;
            }
            
            // Inicializar pestañas
            const tabEls = document.querySelectorAll('button[data-bs-toggle="tab"]');
            tabEls.forEach(tabEl => {
                tabEl.addEventListener('shown.bs.tab', function (event) {
                    if (event.target.id === 'stats-tab') {
                        updateStats();
                    }
                });
            });
        });
    </script>
</body>
</html>
